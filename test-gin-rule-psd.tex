% #!rm -f testfiles/tigerpsdfmt4* && ptex2pdf -l -u -ot '-shell-escape' -od '-v' test-gin-rule-psd
% #!rm -f testfiles/tigerpsdfmt4* && xelatex -shell-escape test-gin-rule-psd
% #!rm -f testfiles/tigerpsdfmt4* && pdflatex -shell-escape test-gin-rule-psd
%#!rm -f testfiles/tigerpsdfmt4* && lualatex -shell-escape test-gin-rule-psd

% TODO: make this test file generic, getting parameters from \jobname:
% - converter to use
% - image format (for bitmaps, create test images based on the ImageMagick rose)
% - use of the image cache or not
% then create dedicated symlinks in directories by TeX driver (pdflatex, lualatex, etc.)
% and a global bash file to run all tests

\documentclass{article}
\usepackage{graphicx}
\usepackage[%
  %img2pdf,
  magick,%imagemagick,graphicsmagick,%%same as the one;
  % convert,%% old ImageMagick
  cache=true,%%default: false
]{graphicxwand}
\listfiles
\begin{document}
\begin{itemize}
\makeatletter
\item Image-to-PDF: \@gfxwand@converter

\item image cache: \if@gfxwand@imagecache true\else false\fi
\makeatother
\end{itemize}

%% $ file testfiles/tigerpsdfmt.psd
%% testfiles/tigerpsdfmt.psd: Adobe Photoshop Image, 550 x 568, RGBA, 4x 8-bit channels
\includegraphics{testfiles/tigerpsdfmt.psd}
\includegraphics[keepaspectratio, height=\linewidth, width=\linewidth]{IMG_8420.HEIC}
\end{document}

$ pdfinfo testfiles/tigerpsdfmt.4gfxwand.pdf
Title:          tigerpsdfmt.4gfxwand
Producer:       /opt/homebrew/Cellar/imagemagick/7.0.7-15/share/doc/ImageMagick-7//index.html
CreationDate:   Sat Jan 27 00:10:51 2018 JST
ModDate:        Sat Jan 27 00:10:51 2018 JST
Tagged:         no
UserProperties: no
Suspects:       no
Form:           none
JavaScript:     no
Pages:          2
Encrypted:      no
Page size:      99 x 102.24 pts
Page rot:       0
File size:      1052740 bytes
Optimized:      no
PDF version:    1.4

$ pdfinfo testfiles/tigerpsdfmt.4gfxwand.pdf
Producer:       Mac OS X 10.13.4 Quartz PDFContext
CreationDate:   Fri Jan 26 15:12:13 2018 JST
ModDate:        Fri Jan 26 15:12:13 2018 JST
Tagged:         no
UserProperties: no
Suspects:       no
Form:           none
JavaScript:     no
Pages:          1
Encrypted:      no
Page size:      99 x 102.24 pts
Page rot:       0
File size:      112882 bytes
Optimized:      no
PDF version:    1.3
